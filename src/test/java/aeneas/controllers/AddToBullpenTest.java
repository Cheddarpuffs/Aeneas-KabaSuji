package aeneas.controllers;

import org.junit.Test;
import static org.junit.Assert.*;

import aeneas.models.Bullpen;
import aeneas.models.Bullpen.BullpenLogic;
import aeneas.models.Level;
import aeneas.models.LevelGenerator;
import aeneas.models.Model;
import aeneas.models.Piece;
import aeneas.models.PuzzleLevel;
import aeneas.models.Square;
import aeneas.views.BullpenView;
import javafx.scene.layout.VBox;

public class AddToBullpenTest {

  @Test
  public void testAddPieceToNonEditorLevel(){
    Model model = new Model();
    Bullpen bullpen = new Bullpen(BullpenLogic.puzzleLogic());
    Piece testPiece = new Piece(new Square[] {
      new Square(0,0),
    });
    Level l = new PuzzleLevel(bullpen);
    model.setActiveLevel(l);

    VBox bullpenBox = new VBox();
    BullpenView view = new BullpenView(model, bullpenBox, null);
    view.refresh();

    IMove move = new AddPieceMove(bullpen, testPiece);

    assertFalse(move.isValid());
    move.execute();
    assertEquals(bullpen.getPieces().size(), 0);
  }

  @Test
  public void testAddPieceEditorLevel(){
    Model model = new Model();
    Bullpen bullpen = new Bullpen(BullpenLogic.editorLogic());
    Piece testPiece = new Piece(new Square[] {
      new Square(0,0),
    });
    Level l = new PuzzleLevel(bullpen);
    model.setActiveLevel(l);

    VBox bullpenBox = new VBox();
    BullpenView view = new BullpenView(model, bullpenBox, null);
    view.refresh();
    IMove move = new AddPieceMove(bullpen, testPiece);

    assertTrue(move.isValid());
    move.execute();
    assertEquals(bullpen.getPieces().size(), 1);
  }

}
